<!DOCTYPE html>
<html lang="pt-BR">
<head>

  <!-- üî• Anti-cache -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Postos UNISETER ‚Äî Buscar Postos</title>

  <!-- üîê Clerk -->
  <script async crossorigin="anonymous"
    src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"
    data-clerk-publishable-key="pk_test_bHVja3ktc3RpbmtidWctODUuY2xlcmsuYWNjb3VudHMuZGV2JA">
  </script>

  <!-- üîê Bloqueio de acesso -->
  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const c = window.Clerk;
      await c.load();
      if (!c.user) return location.href = "/signin.html";
      document.body.style.display = "block";
    });

    async function sair() {
      const c = window.Clerk;
      await c.load();
      await c.signOut();
      location.href = "/signin.html";
    }
  </script>

  <!-- üé® CSS global -->
  <link rel="stylesheet" href="style.css?v=202501">

  <!-- üìÑ PDFs -->
  <script src="pdfmake.min.js"></script>
  <script src="vfs_fonts.js"></script>
  <script src="pdf-geral.js"></script>

  <!-- üîê Anti-flash + UX busca -->
  <style>
    body { display: none; }

    .search-box {
      max-width: 520px;
      margin: 24px auto 0;
      position: relative;
    }

    .search-wrapper {
      position: relative;
    }

    .search-icon {
      position: absolute;
      left: 14px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 18px;
      color: #666;
      pointer-events: none;
    }

    #search {
      width: 100%;
      padding: 14px 44px 14px 42px;
      font-size: 16px;
      border-radius: 12px;
      border: 2px solid #003c8d;
      outline: none;
      box-sizing: border-box;
    }

    #search:focus {
      border-color: #005edb;
      box-shadow: 0 0 0 3px rgba(0, 94, 219, 0.15);
    }

    #search::placeholder {
      color: #777;
      font-size: 15px;
    }

    .clear-btn {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 18px;
      cursor: pointer;
      color: #999;
      display: none;
    }

    .clear-btn:hover {
      color: #333;
    }

    @media (max-width: 600px) {
      .search-box {
        margin-top: 16px;
      }
    }
  </style>

</head>

<body>

  <!-- ===== HEADER ===== -->
  <header style="
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
  ">
    <h2 style="margin:0;">Postos UNISETER</h2>

    <div style="display:flex;gap:8px;">
      <button onclick="location.href='home.html'"
        style="padding:6px 10px;border-radius:6px;border:1px solid #bbb;cursor:pointer;">
        ‚Üê Menu
      </button>

      <button onclick="sair()"
        style="padding:6px 10px;border-radius:6px;border:1px solid #bbb;cursor:pointer;">
        Sair
      </button>
    </div>
  </header>

  <!-- ===== BUSCA ===== -->
  <div class="search-box">
    <div class="search-wrapper">
      <span class="search-icon">üîç</span>

      <input
        id="search"
        type="text"
        placeholder="Buscar posto por nome, cidade ou endere√ßo‚Ä¶"
        autocomplete="off"
        oninput="document.querySelector('.clear-btn').style.display = this.value ? 'block' : 'none';"
      >

      <button
        class="clear-btn"
        onclick="
          document.getElementById('search').value='';
          document.getElementById('suggestions').innerHTML='';
          document.getElementById('details').innerHTML='';
          this.style.display='none';
        ">
        ‚úï
      </button>
    </div>

    <div id="suggestions"></div>
  </div>

  <!-- ===== DETALHES ===== -->
  <div id="details" style="margin-top:20px;"></div>

  <!-- ===== A√á√ïES ===== -->
  <div style="margin-top:20px;">
    <button onclick="gerarPDFGeral()">üìÑ Gerar PDF Geral de Todos os Postos</button>
  </div>

  <!-- ‚ö†Ô∏è JS PRINCIPAL SEMPRE POR √öLTIMO -->
  <script src="app.js?v=202501"></script>

</body>
</html>
