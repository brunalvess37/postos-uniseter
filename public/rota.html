<!DOCTYPE html>
<html lang="pt-BR">
<head>

<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Rota â€” Postos UNISETER</title>
<link rel="stylesheet" href="style.css">

<!-- Clerk AutenticaÃ§Ã£o -->
<script async crossorigin="anonymous"
src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"
data-clerk-publishable-key="pk_test_bHVja3ktc3RpbmtidWctODUuY2xlcmsuYWNjb3VudHMuZGV2JA"></script>

<!-- ğŸ” BLOQUEIO DE ACESSO -->
<script>
document.addEventListener("DOMContentLoaded", async ()=>{
    const c = window.Clerk;
    await c.load();

    if(!c.user) return location.href="/signin.html"; // precisa estar logado
});

/* ğŸ”˜ logout */
async function sair(){
   const c = window.Clerk;
   await c.load();
   await c.signOut();
   location.href="/signin.html";
}
</script>

<!-- Scripts essenciais -->
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
<script src="pdfmake.min.js"></script>
<script src="vfs_fonts.js"></script>
<script src="pdf-rota.js"></script>
<script src="rota.js"></script>

<style>
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:10px;
}
button{
  margin:4px;
  padding:8px 14px;
  border-radius:8px;
  border:1px solid #ccc;
  cursor:pointer;
  font-size:14px;
}
</style>

</head>
<body>

<header>
  <button onclick="location='home.html'">â† Menu</button>
  <h2 style="margin:0;">Rota â€” Postos UNISETER</h2>
  <button onclick="sair()">Sair</button>
</header>

<p id="rota-info"></p>
<div id="rota-lista"></div>

<hr>
<button onclick="toggleMapa()">ğŸ—º Mostrar / Ocultar Mapa</button>
<div id="mapa" style="height:0;overflow:hidden;transition:.4s"></div>

<hr>
<button onclick="ordenarRota()">ğŸ“ Otimizar rota</button>
<button onclick="salvarRota()">ğŸ’¾ Salvar</button>
<button onclick="limparRota()">ğŸ—‘ Limpar</button>
<button onclick="abrirNoWaze()">ğŸš— Abrir no Waze</button>
<button onclick="gerarPDFRota()">ğŸ“„ PDF da Rota</button>

</body>
</html>
