<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Admin â€” Upload de Planilha</title>
<link rel="stylesheet" href="style.css">

<!-- Clerk -->
<script async crossorigin="anonymous"
src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"
data-clerk-publishable-key="pk_test_bHVja3ktc3RpbmtidWctODUuY2xlcmsuYWNjb3VudHMuZGV2JA"></script>

<script>
document.addEventListener("DOMContentLoaded", async ()=>{

  const adminEmail = "brunalvess@hotmail.com";   // ğŸ”¥ ADMIN MASTER

  const c = window.Clerk;
  await c.load();

  /* 1) Se nÃ£o estiver logado â†’ login */
  if(!c.user){
      return location.href="/signin.html";
  }

  /* 2) Se logado mas nÃ£o for admin â†’ bloqueia */
  if(c.user.primaryEmailAddress.emailAddress !== adminEmail){
      alert("âŒ Acesso restrito. Ãrea somente para administradores.");
      return location.href="/home.html";
  }

  /* 3) Se chegou aqui â†’ Ã© administradora e pode usar normalmente ğŸ‘‡ */
});
</script>
</head>

<body>

<h1>Admin â€” Atualizar Planilha</h1>
<p>Enviar arquivo XLSX com cadastro de Postos UNISETER</p>

<input id='file' type='file' accept='.xls,.xlsx'>
<pre id='preview'></pre>
<button id='sendBtn' style='display:none;'>ğŸ“¤ Enviar para Servidor</button>

<script src="xlsx.full.min.js"></script>
<script src="admin.js"></script>

</body>
</html>
