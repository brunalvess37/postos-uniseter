<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Admin â€” Upload de Planilha</title>

<link rel="stylesheet" href="style.css">

<!-- Clerk -->
<script async crossorigin="anonymous"
src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"
data-clerk-publishable-key="pk_test_bHVja3ktc3RpbmtidWctODUuY2xlcmsuYWNjb3VudHMuZGV2JA"></script>

<script>
document.addEventListener("DOMContentLoaded", async ()=>{

  const adminEmail = "brunalvess@hotmail.com";   // ğŸ”¥ ADMIN MASTER

  const c = window.Clerk;
  await c.load();

  // ğŸ” 1) Redirecionar para login se nÃ£o autenticado
  if(!c.user) return location.href="/signin.html";

  // ğŸ”’ 2) Se logado mas nÃ£o autorizado â†’ bloquear
  if(c.user.primaryEmailAddress.emailAddress !== adminEmail){
      alert("âŒ Ãrea restrita â€” somente administradores");
      return location.href="/home.html";
  }
});

/* ğŸ”˜ Logout */
async function sair(){
    const c = window.Clerk;
    await c.load();
    await c.signOut();
    location.href="/signin.html";
}
</script>

<style>
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:10px;
}
button{
  padding:8px 14px;
  border-radius:8px;
  border:1px solid #ccc;
  cursor:pointer;
  margin-right:5px;
}
</style>

</head>
<body>

<header>
  <button onclick="location='home.html'">â† Menu</button>
  <h2 style="margin:0;">Admin â€” Atualizar Planilha</h2>
  <button onclick="sair()">Sair</button>
</header>

<p>Selecione o arquivo XLSX com os postos cadastrados</p>

<input id='file' type='file' accept='.xls,.xlsx'>
<pre id='preview'></pre>
<button id='sendBtn' style='display:none;margin-top:10px;'>ğŸ“¤ Enviar para o servidor</button>

<script src="xlsx.full.min.js"></script>
<script src="admin.js"></script>

</body>
</html>
