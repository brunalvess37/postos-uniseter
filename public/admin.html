<!doctype html>
<html lang="pt-BR">
<head>

<!-- ğŸ”¥ Anti-cache -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Admin â€” Upload de Planilha</title>

<link rel="stylesheet" href="style.css?v=202501">

<!-- Clerk -->
<script async crossorigin="anonymous"
src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"
data-clerk-publishable-key="pk_test_bHVja3ktc3RpbmtidWctODUuY2xlcmsuYWNjb3VudHMuZGV2JA"></script>

<script>
document.addEventListener("DOMContentLoaded", async ()=>{

  const adminEmail = "brunalvess@hotmail.com";  // ğŸ”¥ Admin master
  await Clerk.load();

  // ğŸ” Se nÃ£o estiver logado â†’ login
  if(!Clerk.user) return location.href="/signin.html";

  // ğŸ”’ Se logado mas NÃƒO for admin â†’ bloquear
  if(Clerk.user.primaryEmailAddress.emailAddress !== adminEmail){
      alert("âŒ Acesso restrito â€” somente administradores");
      return location.href="/home.html";
  }
  document.body.style.display = "block"; // âœ… libera tela sÃ³ para admin
});

async function sair(){
  await Clerk.load();
  await Clerk.signOut();
  location.href="/signin.html";
}
</script>

<style>
body{
  display:none;   /* ğŸ” anti-flash */
}
  
header{
  display:flex; justify-content:space-between; align-items:center;
  padding:10px; border-bottom:1px solid #ccc;
}
button{
  padding:8px 14px; border-radius:8px; border:1px solid #ccc;
  cursor:pointer; margin-right:5px;
}
</style>
</head>

<body>

<header>
  <button onclick="location='home.html'">â† Menu</button>
  <h2 style="margin:0;">Admin â€” Atualizar Planilha</h2>
  <button onclick="sair()">Sair</button>
</header>

<p>Selecione o arquivo XLSX com os postos cadastrados</p>

<input id='file' type='file' accept='.xls,.xlsx'>
<pre id='preview'></pre>
<button id="sendBtn"
        disabled
        style="margin-top:10px;opacity:.5;cursor:not-allowed;">
  ğŸ“¤ Enviar Planilha
</button>

<p id="status" style="font-size:13px;color:#555;margin-top:6px;">
  Selecione uma planilha para habilitar o envio.
</p>


<!-- Agora com anti-cache e upload Cloudflare -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="admin.js?v=202501"></script>

</body>
</html>
